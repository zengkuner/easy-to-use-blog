## 简单理解 XSS 和 CSRF

用生活化的例子和简单步骤来解释这两种攻击：

---

### **1. XSS（跨站脚本攻击）——像“纸条里的陷阱”**

**攻击过程：**

- **步骤 1：埋陷阱**  
  攻击者在网站能显示用户内容的地方（比如评论区、昵称）插入一段恶意代码。比如，写一个评论：  
  `<script>偷偷发送你的Cookie到黑客网站</script>`。

- **步骤 2：触发陷阱**  
  当你浏览这条评论时，网站没有过滤这段代码，你的浏览器会**老老实实执行它**，比如把你的登录凭证（Cookie）悄悄传给攻击者。

- **结果：**  
  攻击者拿到你的 Cookie 后，就能冒充你登录账号，盗取信息或进行恶意操作。

**生活比喻：**  
就像有人在图书馆的留言本上写了一条“隐形指令”，下一个人翻开时，指令自动执行，偷走了他的借书证。

---

### **2. CSRF（跨站请求伪造）——像“假冒你的签名”**

**攻击过程：**

- **步骤 1：你已登录**  
  假设你登录了网银，浏览器保存了你的登录状态（Cookie）。

- **步骤 2：诱导点击**  
  攻击者发给你一个链接（比如伪装成抽奖页面），里面藏着一个自动提交的请求：  
  `<img src="http://银行.com/转账?金额=1000&账户=黑客">`。

- **步骤 3：自动执行**  
  你一点开链接，浏览器会自动带着你的 Cookie 向银行网站发送“转账请求”。银行以为是**你本人操作**，因为 Cookie 是对的。

- **结果：**  
  钱被转走，而你可能完全不知情。

**生活比喻：**  
就像有人偷偷拿走你的印章，在你不知情时伪造了一份合同，银行看到印章就信以为真。

---

### **区别总结**

- **XSS：** 利用**用户对网站的信任**，在网页里植入恶意代码，直接窃取信息。
- **CSRF：** 利用**网站对浏览器的信任**，伪造你的身份偷偷发送请求。

---

### **如何防御？**

- **防 XSS：** 网站对用户输入的内容严格过滤（比如转义`<`、`>`等符号），就像给留言本上的内容消毒。
- **防 CSRF：** 网站要求请求携带随机 Token（类似动态口令），或者检查请求来源，就像合同不仅要盖章还要本人签字。

希望这样解释能帮你轻松理解！ 😊

### XSS 跨站脚本攻击：分成反射型、存储型、基于 DOM 攻击

#### 反射+存储的解决方案：

- 最简单的就是纯前端渲染，数据和代码分开，并且对 html 进行充分转义。
- 用户的输入都不能信，需要检查转义、过滤。
- 【**答题要点**】浏览器也给出了`httpOnly`标准，禁止页面 js 访问带有该属性的`cookie`。

#### DOM 攻击的解决方案：

- 最简单的还是对特殊字符转义、编码。
- 给`a`的`href`跳转链接添加白名单过滤，禁止`JavaScript`开头的链接。
- 【**答题要点**】浏览器也给出了`CSP`内容安全策略。
- **【补充】**`CSP`：只信任白名单网站下的外部资源，使用方式：

  - 响应头 `Content-Security-Policy: script-src 'self'`;
  - 网页的`meta`标签。

    ```html
    <meta
      http-equiv="Content-Security-Policy"
      content="script-src 'self'; object-src 'none'"
    />
    ```

### CSRF 跨站请求伪造

定义：一般在第三方网站发生，冒用受害者的 cookie 信息骗取服务器信任（攻击者无法获取 cookie），提交操作。

解决方案：

- 验证码
- 同源验证`Referer`域名校验
- `token`验证（在请求头中放入攻击者不存储于`cookie`的信息）
- 双重`cookie`验证（在 HTTPS 情况下使用，请求中携带某一`cookie`字段）
